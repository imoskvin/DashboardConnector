# Установка DataLens коннектора 1С на компьютеры под управлением Windows

## Требования к предварительно установленному программному обеспечению

Для работы и установки требуются следующие компоненты:

- Internet Information Server (IIS)
- PowerShell

Для PowerShell должен быть разрешен запуск сценариев. Для этого необходимо в консоли PowerShell, запущенной как Администратор, выполнить ниже приведенную команду:

```powershell
Set-Executionpolicy -Scope CurrentUser -ExecutionPolicy UnRestricted`
```

Установка должна производится пользователем с правами локального администратора.

## Стороннее программное обеспечение, устанавливаемое вместе с 1С коннектором

В процессе установки **1С коннектора** на машину устанавливается программное обеспечение третьих сторон:

| Производитель     | Программное обеспечение                                      |
| ----------------- | ------------------------------------------------------------ |
| Apache Foundation | Документо-ориентированная СУБД Apache CouchDB 2.3.1 (https://couchdb.apache.org/) |
| Microsoft         | Среда выполнения веб приложений .NET Core 2.2.7              |

## Установка 1С коннектор

Для установки нужно выбрать, в зависимости от разрядности ОС Windows на используемой машине, файл архива с установочными файлами:

- для 32-х разрядной Windows файл с названием 1CDataLensConnector_XXX_win_x86.zip, где вместо XXX будут стоять цифры с обозначением версии;

- для 64-х разрядной Windows файл с названием 1CDataLensConnector_XXX_win_x64.zip, где вместо XXX будут стоять цифры с обозначением версии.

После загрузки файл необходимо разархивировать. 

Установка 1С коннектора производится путем запуска скрипта PowerShell install.ps1 с использованием следующих параметров:

| Параметр  | Значение                                                     |
| --------- | ------------------------------------------------------------ |
| $port     | Значение http порта для создаваемого сайта. Принимает числовые значения. Значение по умолчанию - 8080 |
| $sitename | Название сайта в IIS. Принимает строковые значения. Значение по умолчанию 1cconn |

Например, вызов скрипта может быть выполнен следующим образом:

```powershell
install.ps1 -$port 8080 -$sitename 1cconn
```

После установки можно протестировать доступ к сайту 1С коннектора переходом по ссылке http://localhost:8080, при этом доступ к сайту может быть осуществлен с другого компьютера в локальной сети , например http://hostname:8080

Если все работает, можно считать установку 1С Коннектора законченной.

